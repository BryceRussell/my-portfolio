---
import Base from "@/layouts/Base.astro";
import CodeTagIcons from '@/components/CodeTagIcons.astro';
import type { Frontmatter } from '@/types';

const projects = await Astro.glob<Frontmatter>('../projects/*.md');
const articles = await Astro.glob<Frontmatter>('../blog/*.md');

const recent = [...projects, ...articles]
    .filter(article => article && article.frontmatter.draft !== true)
    .sort((a, b) => new Date(''+b.frontmatter.date).valueOf() - new Date(''+a.frontmatter.date).valueOf());
---

<Base>
    <hgroup class="flex flex-col w-fit my-20 mx-auto">
        <h1 class="font-bold text-fluid-9 p-0">Bryce Russell</h1>
        <p class="p-0 text-fluid-6">Web Developer</p>
    </hgroup>
    <section>
            <h2 class="mb-3">Recent</h2>
            <ul class="flex flex-col gap-5">
                { recent.map((article) => {
                    const {
                        title,
                        slug,
                        package: pkg,
                        description,
                        date,
                        tags=[]
                    } = article.frontmatter
                    const type = article.file.split('/').reverse()[1]
                    return (
                    <li>
                        <a href={`/${type}/${slug}`} class="text-darker font-bold">{type === "blog"?title:pkg||slug}</a>
                        <div class="flex flex-col sm:flex-row items-start gap-x-3 text-fluid-0">
                            <time class="whitespace-nowrap text-grayer">{(new Date(''+date)).toDateString()}</time>
                            <div class="flex flex-wrap gap-x-3">                            
                                {tags.map((tag) => {
                                    return <a href={`/${type}/tags/${tag}`}>#{tag}</a>
                                })}
                            </div>
                        </div>
                        <p class="text-fluid-0">{description}</p>
                    </li>
                    )
                })}
            </ul>
    </section>
</Base>